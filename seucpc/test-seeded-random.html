<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç§å­éšæœºæ•°æµ‹è¯•</title>
  <style>
    body {
      font-family: 'Microsoft YaHei', sans-serif;
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
    }
    h2 {
      color: #3498db;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
    }
    button:hover {
      background: #2980b9;
    }
    .success {
      color: #27ae60;
      font-weight: bold;
    }
    .fail {
      color: #e74c3c;
      font-weight: bold;
    }
    .result {
      background: #ecf0f1;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
    }
    input {
      padding: 8px;
      border: 1px solid #bdc3c7;
      border-radius: 4px;
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>ğŸ² ç§å­éšæœºæ•°ä¸€è‡´æ€§æµ‹è¯•</h1>
  
  <div class="test-section">
    <h2>æµ‹è¯•è¯´æ˜</h2>
    <p>æ­¤é¡µé¢ç”¨äºéªŒè¯ç§å­éšæœºæ•°ç”Ÿæˆå™¨ (SeededRandom) æ˜¯å¦èƒ½äº§ç”Ÿä¸€è‡´çš„éšæœºæ•°åºåˆ—ã€‚</p>
    <p><strong>æµ‹è¯•åŸç†ï¼š</strong>ä½¿ç”¨ç›¸åŒçš„ç§å­åˆå§‹åŒ–ä¸¤æ¬¡ï¼Œåº”è¯¥å¾—åˆ°å®Œå…¨ç›¸åŒçš„éšæœºæ•°åºåˆ—ã€‚</p>
  </div>

  <div class="test-section">
    <h2>1. åŸºç¡€ä¸€è‡´æ€§æµ‹è¯•</h2>
    <p>ä½¿ç”¨å›ºå®šç§å­ 12345ï¼Œç”Ÿæˆä¸¤ç»„éšæœºæ•°å¹¶å¯¹æ¯”</p>
    <button onclick="testBasicConsistency()">è¿è¡Œæµ‹è¯•</button>
    <div id="test1-result"></div>
  </div>

  <div class="test-section">
    <h2>2. è‡ªå®šä¹‰ç§å­æµ‹è¯•</h2>
    <p>è¾“å…¥ä»»æ„ç§å­å€¼ï¼ŒéªŒè¯æ˜¯å¦èƒ½äº§ç”Ÿä¸€è‡´çš„éšæœºæ•°</p>
    <input type="number" id="custom-seed" placeholder="è¾“å…¥ç§å­å€¼" value="20251016">
    <input type="number" id="random-count" placeholder="ç”Ÿæˆæ•°é‡" value="10">
    <button onclick="testCustomSeed()">è¿è¡Œæµ‹è¯•</button>
    <div id="test2-result"></div>
  </div>

  <div class="test-section">
    <h2>3. ä»Šæ—¥æŒ‘æˆ˜ç§å­æµ‹è¯•</h2>
    <p>æµ‹è¯•ä»Šæ—¥æŒ‘æˆ˜åŠŸèƒ½ç”Ÿæˆçš„ç§å­</p>
    <button onclick="testDailyChallengeConsistency()">è¿è¡Œæµ‹è¯•</button>
    <div id="test3-result"></div>
  </div>

  <div class="test-section">
    <h2>4. æ¸¸æˆé€»è¾‘æ¨¡æ‹Ÿæµ‹è¯•</h2>
    <p>æ¨¡æ‹Ÿå®é™…æ¸¸æˆåœºæ™¯ï¼šå­¦ç”Ÿåå­—ç”Ÿæˆã€å¤©èµ‹åˆ†é…ç­‰</p>
    <button onclick="testGameLogic()">è¿è¡Œæµ‹è¯•</button>
    <div id="test4-result"></div>
  </div>

  <script src="game.js"></script>
<script src="render.js"></script>
<script src="debug.js"></script>
  <script>
    // æµ‹è¯•1ï¼šåŸºç¡€ä¸€è‡´æ€§
    function testBasicConsistency() {
      const seed = 12345;
      const count = 10;
      
      // ç¬¬ä¸€æ¬¡ç”Ÿæˆ
      setRandomSeed(seed);
      const sequence1 = [];
      for (let i = 0; i < count; i++) {
        sequence1.push(getRandom());
      }
      
      // ç¬¬äºŒæ¬¡ç”Ÿæˆ
      setRandomSeed(seed);
      const sequence2 = [];
      for (let i = 0; i < count; i++) {
        sequence2.push(getRandom());
      }
      
      // å¯¹æ¯”ç»“æœ
      let isConsistent = true;
      for (let i = 0; i < count; i++) {
        if (sequence1[i] !== sequence2[i]) {
          isConsistent = false;
          break;
        }
      }
      
      const resultDiv = document.getElementById('test1-result');
      resultDiv.innerHTML = `
        <div class="result">
          <strong>åºåˆ—1ï¼š</strong><br>${sequence1.map(n => n.toFixed(6)).join(', ')}<br><br>
          <strong>åºåˆ—2ï¼š</strong><br>${sequence2.map(n => n.toFixed(6)).join(', ')}<br><br>
          <strong>ç»“æœï¼š</strong><span class="${isConsistent ? 'success' : 'fail'}">
            ${isConsistent ? 'âœ“ é€šè¿‡ - ä¸¤æ¬¡ç”Ÿæˆçš„åºåˆ—å®Œå…¨ä¸€è‡´ï¼' : 'âœ— å¤±è´¥ - åºåˆ—ä¸ä¸€è‡´ï¼'}
          </span>
        </div>
      `;
    }

    // æµ‹è¯•2ï¼šè‡ªå®šä¹‰ç§å­
    function testCustomSeed() {
      const seed = parseInt(document.getElementById('custom-seed').value);
      const count = parseInt(document.getElementById('random-count').value);
      
      if (isNaN(seed) || isNaN(count)) {
        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼');
        return;
      }
      
      // ç¬¬ä¸€æ¬¡ç”Ÿæˆ
      setRandomSeed(seed);
      const sequence1 = [];
      for (let i = 0; i < count; i++) {
        sequence1.push(getRandom());
      }
      
      // ç¬¬äºŒæ¬¡ç”Ÿæˆ
      setRandomSeed(seed);
      const sequence2 = [];
      for (let i = 0; i < count; i++) {
        sequence2.push(getRandom());
      }
      
      // å¯¹æ¯”
      let isConsistent = sequence1.every((val, idx) => val === sequence2[idx]);
      
      const resultDiv = document.getElementById('test2-result');
      resultDiv.innerHTML = `
        <div class="result">
          <strong>ç§å­ï¼š</strong>${seed}<br>
          <strong>ç”Ÿæˆæ•°é‡ï¼š</strong>${count}<br><br>
          <strong>åºåˆ—1ï¼š</strong><br>${sequence1.map(n => n.toFixed(6)).join(', ')}<br><br>
          <strong>åºåˆ—2ï¼š</strong><br>${sequence2.map(n => n.toFixed(6)).join(', ')}<br><br>
          <strong>ç»“æœï¼š</strong><span class="${isConsistent ? 'success' : 'fail'}">
            ${isConsistent ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥'}
          </span>
        </div>
      `;
    }

    // æµ‹è¯•3ï¼šä»Šæ—¥æŒ‘æˆ˜ç§å­
    function testDailyChallengeConsistency() {
      if (typeof getDailyChallengeParams !== 'function') {
        document.getElementById('test3-result').innerHTML = `
          <div class="result">
            <span class="fail">âœ— é”™è¯¯ï¼šgetDailyChallengeParams å‡½æ•°æœªå®šä¹‰ï¼</span>
          </div>
        `;
        return;
      }
      
      const params = getDailyChallengeParams();
      const { seed, province, difficulty, date } = params;
      
      // ä½¿ç”¨ä»Šæ—¥ç§å­ç”Ÿæˆä¸¤ç»„æ•°æ®
      setRandomSeed(seed);
      const data1 = {
        names: [generateName(), generateName(), generateName()],
        randoms: [getRandom(), getRandom(), getRandom()]
      };
      
      setRandomSeed(seed);
      const data2 = {
        names: [generateName(), generateName(), generateName()],
        randoms: [getRandom(), getRandom(), getRandom()]
      };
      
      const namesMatch = data1.names.every((name, idx) => name === data2.names[idx]);
      const randomsMatch = data1.randoms.every((val, idx) => val === data2.randoms[idx]);
      const allMatch = namesMatch && randomsMatch;
      
      const resultDiv = document.getElementById('test3-result');
      resultDiv.innerHTML = `
        <div class="result">
          <strong>ä»Šæ—¥æ—¥æœŸï¼š</strong>${date}<br>
          <strong>ç§å­ï¼š</strong>${seed}<br>
          <strong>çœä»½ï¼š</strong>${province}<br>
          <strong>éš¾åº¦ï¼š</strong>${difficulty}<br><br>
          
          <strong>ç¬¬ä¸€æ¬¡ç”Ÿæˆï¼š</strong><br>
          å­¦ç”Ÿåå­—ï¼š${data1.names.join(', ')}<br>
          éšæœºæ•°ï¼š${data1.randoms.map(n => n.toFixed(6)).join(', ')}<br><br>
          
          <strong>ç¬¬äºŒæ¬¡ç”Ÿæˆï¼š</strong><br>
          å­¦ç”Ÿåå­—ï¼š${data2.names.join(', ')}<br>
          éšæœºæ•°ï¼š${data2.randoms.map(n => n.toFixed(6)).join(', ')}<br><br>
          
          <strong>ç»“æœï¼š</strong><span class="${allMatch ? 'success' : 'fail'}">
            ${allMatch ? 'âœ“ é€šè¿‡ - ä»Šæ—¥æŒ‘æˆ˜ç§å­å·¥ä½œæ­£å¸¸ï¼' : 'âœ— å¤±è´¥'}
          </span><br>
          åå­—åŒ¹é…ï¼š${namesMatch ? 'âœ“' : 'âœ—'}<br>
          éšæœºæ•°åŒ¹é…ï¼š${randomsMatch ? 'âœ“' : 'âœ—'}
        </div>
      `;
    }

    // æµ‹è¯•4ï¼šæ¸¸æˆé€»è¾‘æ¨¡æ‹Ÿ
    function testGameLogic() {
      const seed = 99999;
      
      // æ¨¡æ‹Ÿæ¸¸æˆåˆå§‹åŒ–æµç¨‹ï¼ˆä¸¤æ¬¡ï¼‰
      function simulateGameInit(seedValue) {
        setRandomSeed(seedValue);
        
        return {
          students: [
            { name: generateName(), thinking: uniformInt(50, 80), coding: uniformInt(50, 80) },
            { name: generateName(), thinking: uniformInt(50, 80), coding: uniformInt(50, 80) },
            { name: generateName(), thinking: uniformInt(50, 80), coding: uniformInt(50, 80) }
          ],
          weather: {
            temp: normal(20, 5),
            precipitation: getRandom() < 0.3 ? 'é›¨' : 'æ™´'
          },
          eventChance: getRandom()
        };
      }
      
      const game1 = simulateGameInit(seed);
      const game2 = simulateGameInit(seed);
      
      // å¯¹æ¯”
      const studentsMatch = game1.students.every((s, idx) => 
        s.name === game2.students[idx].name &&
        s.thinking === game2.students[idx].thinking &&
        s.coding === game2.students[idx].coding
      );
      
      const weatherMatch = 
        game1.weather.temp === game2.weather.temp &&
        game1.weather.precipitation === game2.weather.precipitation;
      
      const eventMatch = game1.eventChance === game2.eventChance;
      
      const allMatch = studentsMatch && weatherMatch && eventMatch;
      
      const resultDiv = document.getElementById('test4-result');
      resultDiv.innerHTML = `
        <div class="result">
          <strong>æµ‹è¯•ç§å­ï¼š</strong>${seed}<br><br>
          
          <strong>ç¬¬ä¸€æ¬¡æ¨¡æ‹Ÿï¼š</strong><br>
          å­¦ç”Ÿï¼š${game1.students.map(s => `${s.name}(æ€ç»´${s.thinking}/ä»£ç ${s.coding})`).join(', ')}<br>
          å¤©æ°”ï¼š${game1.weather.precipitation} ${game1.weather.temp.toFixed(1)}Â°C<br>
          äº‹ä»¶æ¦‚ç‡ï¼š${game1.eventChance.toFixed(6)}<br><br>
          
          <strong>ç¬¬äºŒæ¬¡æ¨¡æ‹Ÿï¼š</strong><br>
          å­¦ç”Ÿï¼š${game2.students.map(s => `${s.name}(æ€ç»´${s.thinking}/ä»£ç ${s.coding})`).join(', ')}<br>
          å¤©æ°”ï¼š${game2.weather.precipitation} ${game2.weather.temp.toFixed(1)}Â°C<br>
          äº‹ä»¶æ¦‚ç‡ï¼š${game2.eventChance.toFixed(6)}<br><br>
          
          <strong>ç»“æœï¼š</strong><span class="${allMatch ? 'success' : 'fail'}">
            ${allMatch ? 'âœ“ é€šè¿‡ - æ¸¸æˆé€»è¾‘å®Œå…¨å¯å¤ç°ï¼' : 'âœ— å¤±è´¥'}
          </span><br>
          å­¦ç”ŸåŒ¹é…ï¼š${studentsMatch ? 'âœ“' : 'âœ—'}<br>
          å¤©æ°”åŒ¹é…ï¼š${weatherMatch ? 'âœ“' : 'âœ—'}<br>
          äº‹ä»¶åŒ¹é…ï¼š${eventMatch ? 'âœ“' : 'âœ—'}
        </div>
      `;
    }
  </script>
</body>
</html>
