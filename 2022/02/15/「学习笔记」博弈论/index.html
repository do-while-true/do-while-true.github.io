<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"do-while-true.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="很久之前就想开博弈论这个坑了，因为打比赛经常遇到博弈问题结论题，只能靠感觉来做，没有系统的学习过博弈论。">
<meta property="og:type" content="article">
<meta property="og:title" content="「学习笔记」博弈论">
<meta property="og:url" content="https://do-while-true.github.io/2022/02/15/%E3%80%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%8D%E5%8D%9A%E5%BC%88%E8%AE%BA/index.html">
<meta property="og:site_name" content="do_while_true&#39;s blog">
<meta property="og:description" content="很久之前就想开博弈论这个坑了，因为打比赛经常遇到博弈问题结论题，只能靠感觉来做，没有系统的学习过博弈论。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-02-14T16:00:00.000Z">
<meta property="article:modified_time" content="2022-04-06T15:19:45.007Z">
<meta property="article:author" content="do-while-true">
<meta property="article:tag" content="博弈论">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://do-while-true.github.io/2022/02/15/%E3%80%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%8D%E5%8D%9A%E5%BC%88%E8%AE%BA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>「学习笔记」博弈论 | do_while_true's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">do_while_true's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">晚风中闪过 几帧从前啊</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">16</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">3</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">13</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://do-while-true.github.io/2022/02/15/%E3%80%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%8D%E5%8D%9A%E5%BC%88%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.gif">
      <meta itemprop="name" content="do-while-true">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="do_while_true's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          「学习笔记」博弈论
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-15 00:00:00" itemprop="dateCreated datePublished" datetime="2022-02-15T00:00:00+08:00">2022-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-06 23:19:45" itemprop="dateModified" datetime="2022-04-06T23:19:45+08:00">2022-04-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>很久之前就想开博弈论这个坑了，因为打比赛经常遇到博弈问题结论题，只能靠感觉来做，没有系统的学习过博弈论。</p>
<span id="more"></span>
<p>前一周数学老师在一节数学课下课前提了一个好玩的游戏，顿时风靡全班。</p>
<blockquote>
<p>注：本篇文章动笔于 2020.12.16</p>
</blockquote>
<p>这个游戏是这样的：现在有 $30$ 个数要报，两个人轮流报数，每次最多报 $2$ 个数，最少报 $1$ 个数，先报到 $30$ 的人赢。</p>
<p>数学老师找了几个人来玩 <del>(因为她认为我破坏游戏平衡就把我ban掉了)</del>，每次都是她后手，而她每次都赢，于是许多同学开始试怎样报数必赢，许多同学发现了后手的必赢策略，只要对方报奇数则他报偶数，否则报奇数。那么为什么这个策略是必胜的呢？数学老师估计是忘了或者根本没打算讲，于是这个坑由我来填了！</p>
<p>考虑上面那个必胜策略的证明其实很简单，因为后手每次都会取到 $3$ 的倍数，而要取的数正是 $3$ 的倍数，所以后手一定会取到 $30$。</p>
<p>限于笔者能力，本文可能会有许多不严谨甚至错误之处，欢迎指出！</p>
<h1 id="Part1-从经典取石子游戏开始"><a href="#Part1-从经典取石子游戏开始" class="headerlink" title="Part1 从经典取石子游戏开始"></a>Part1 从经典取石子游戏开始</h1><p>现在让我们了解几个定义：</p>
<p><strong>先手和后手</strong></p>
<p>对于游戏中的面临的一个状态称作<strong>局面</strong>，在一个局面下，先进行行动的称作<strong>先手</strong>，后行动的为<strong>后手</strong>。</p>
<p><strong>必胜和必败</strong></p>
<p>对于博弈中一个局面（也可以说是状态）下：</p>
<p>若先手无论采取什么行动都会输掉游戏，则为<strong>必败点</strong>，后文也会称其为 <strong>必败局面</strong>；</p>
<p>双方都操作最优的情况下先手必胜的局面为<strong>必胜点</strong>，后文也会称其为 <strong>必胜局面</strong>。</p>
<p>一般情况下讨论的博弈问题为双方都足够聪明（也就是每一步都是最优操作）。</p>
<p><strong>公平组合游戏 (Impartial Combinatorial Games, 简称ICG)</strong></p>
<ol>
<li><p>终止的局面为必败点。</p>
</li>
<li><p>一个局面可以执行的合法操作和轮到哪一名玩家无关。</p>
</li>
<li><p>两名玩家交替行动。</p>
</li>
</ol>
<p>满足这三个条件的游戏成为<strong>公平组合游戏</strong>。</p>
<h2 id="巴什博弈"><a href="#巴什博弈" class="headerlink" title="巴什博弈"></a>巴什博弈</h2><p>那么现在，让我们来考虑前言所提到的问题的一般情况：</p>
<p>首先，给这个有趣的游戏建立一个模型，也就是把这个问题用数学语言描述出来：</p>
<blockquote>
<p>现在有 $n$ 个石子要取，两个人轮流取石子，每次最多取 $m$ 个石子，最少取 $1$ 个石子，取走第 $n$ 个石子的人赢得游戏。其中满足 $n,m &gt; 0$。考虑两个人都足够聪明的情况下判断先手还是后手必胜，并解释必胜策略。</p>
</blockquote>
<p>我们称这个问题为巴什博弈 (Bash Game)。</p>
<p>当 $n\leq m$ 的时候先手必胜，因为先手可以第一次就把 $n$ 个石子全取完。</p>
<p>那么当 $n&gt;m$ 时呢？</p>
<p>假设 $(m+1) \mid n$，那么先手取 $x$ 个时，后手取 $(m+1-x)$ 个，这样可以保证后手每次都是取到 $(m+1)$ 的倍数，最终取到 $n$ （因为 $n$ 是 $(m+1)$ 的倍数），所以 $(m+1) \mid n$ 时先手必败。</p>
<p>否则的话，先手先取 $n\bmod (m+1)$ 个石子，这样就相当于把 $n$ 减去了 $n\bmod (m+1)$，使得 $n$ 是 $(m+1)$ 的倍数，同时把先手扔给对方，后面的策略就和上面的后手必胜策略一样了，所以 $(m+1)\nmid n$ 时先手必胜。</p>
<p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1846">题目：HDU 1846</a></p>
<h2 id="Nim-游戏"><a href="#Nim-游戏" class="headerlink" title="Nim 游戏"></a>Nim 游戏</h2><blockquote>
<p>给定 $n$ 堆物品，第 $i$ 堆物品有 $A_i$ 个。两名玩家轮流行动，每次可以任选一堆，取走任意多个物品，可以一堆取光，但不能不取。取走最后一件物品则<strong>获胜</strong>。两人都采取最优策略，问先手能否获胜。</p>
</blockquote>
<p>结论：对于 Nim 游戏的一个局面 $(A_1,A_2,\ldots,A_n)$ 来说，先手必败当且仅当 $A_1 \oplus A_2 \oplus \ldots \oplus A_n=0$。</p>
<p>注：其中 $\oplus$ 是异或即 $\text{xor}$，后文均以此记号表示异或。</p>
<p>证明：</p>
<p> $(0,0,\ldots,0)$ 中 $A_1 \oplus A_2 \oplus \ldots \oplus A_n=0$ 为必败局面。</p>
<p>对于 $(A_1,A_2,\ldots,A_n)$ 若 $A_1 \oplus A_2 \oplus \ldots \oplus A_n = x \neq 0$，则可以选择 $x$ 的最高二进制位 $k$，则一定存在一个 $A_i$，它的第 $k$ 位是 $1$，则满足 $A_i \oplus x&lt; A_i$，选取 $A_i$ 使其变成 $A_i\oplus x$ 将这个局面即可转换成 $A_1 \oplus A_2 \oplus \ldots \oplus A_n = 0$。</p>
<p>对于 $(A_1,A_2,\ldots,A_n)$ 若 $A_1 \oplus A_2 \oplus \ldots \oplus A_n = 0$，不管怎么取一定只能到达 $A_1 \oplus A_2 \oplus \ldots \oplus A_n \neq 0$ 的局面，可以选择反证法证明，若选取了 $A_i$ 使其变成 ${A_i}’$，由于 $A_1 \oplus A_2 \oplus \ldots \oplus A_i\oplus \ldots \oplus A_n = 0$ , $A_1 \oplus A_2 \oplus \ldots \oplus {A_i}’\oplus \ldots \oplus A_n = 0$ ，两式相异或得 $A_i\oplus {A_i}’=0,A_i={A_i}’$，与不能不取的规则相矛盾。</p>
<p>再由数学归纳法可知结论的正确性。</p>
<p>证毕。</p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2197">题目：洛谷P2197</a></p>
<h1 id="Part2-博弈论的其他知识点"><a href="#Part2-博弈论的其他知识点" class="headerlink" title="Part2 博弈论的其他知识点"></a>Part2 博弈论的其他知识点</h1><h2 id="有向图游戏"><a href="#有向图游戏" class="headerlink" title="有向图游戏"></a>有向图游戏</h2><blockquote>
<p>有一个 DAG，最初有一枚棋子在起点上，可以让棋子向任意一个连向的点走一步。两名玩家交替操作，不能走的玩家失败。</p>
</blockquote>
<p>注意到任意一个公平组合游戏都能转换成一个有向图游戏，把局面看成点，一个操作看成当前局面到下一个局面连的有向边即可。</p>
<h2 id="Mex-运算"><a href="#Mex-运算" class="headerlink" title="Mex 运算"></a>Mex 运算</h2><p>对于一个仅包含非负整数的可空集合 $S$，定义 $mex(S)$ 为未在 $S$ 中出现且最小的非负整数，也就是：</p>
<script type="math/tex; mode=display">
\text{mex}(S)=\min\{x|x\in \mathbb{N}, x\not\in S\}</script><h2 id="SG-函数"><a href="#SG-函数" class="headerlink" title="SG 函数"></a>SG 函数</h2><p>在一个DAG上，对于每个节点 $x$，假设它能到达的节点为 $S$，则：</p>
<script type="math/tex; mode=display">
SG(x)=\text{mex}(\{SG(k)|k\in S\})</script><p>特别地，当 $S$ 为空时 $SG(x)=0$。</p>
<p>对于一个DAG $G$，它的 SG 函数定义为它起点的 SG 函数值。</p>
<p>显然地，SG函数有以下性质：</p>
<ol>
<li>对于任意的局面，如果它的 SG 值为 0，那么它的任何一个后继局面的 SG 值不为 0；</li>
<li>对于任意的局面，如果它的 SG 值不为 0，那么它一定有一个后继局面的 SG 值为 0。</li>
</ol>
<h2 id="有向图游戏胜负判断"><a href="#有向图游戏胜负判断" class="headerlink" title="有向图游戏胜负判断"></a>有向图游戏胜负判断</h2><blockquote>
<p>一个有向图游戏 $G$ 的一个局面 $x$ 为必胜局面当且仅当 $SG(x)\neq 0$。</p>
</blockquote>
<ol>
<li><p>若 $x$ 没有出边则 $SG(x)=0$，必败局面。</p>
</li>
<li><p>若 $x$ 有出边且 $SG(x)\neq 0$，则一定存在一个后继节点 $y$ 其中 $SG(y)=0$ ，走到这个节点即可，必胜局面。</p>
</li>
<li><p>若 $x$ 有出边且 $SG(x)=0$，则无论走到哪个后继节点 $y$，都会有 $SG(y)\neq 0$，由 2. 可知走完这一步为必胜局面，也就是无论怎么走都会使得对方走到必胜局面，则这个局面是必败局面。</p>
</li>
</ol>
<p>证毕。</p>
<h2 id="有环有向图游戏"><a href="#有环有向图游戏" class="headerlink" title="有环有向图游戏"></a>有环有向图游戏</h2><p>名字是我自己乱起的，其定义如下：</p>
<blockquote>
<p>有一个有向图，最初有一枚棋子在起点上，可以让棋子向任意一个连向的点走一步。两名玩家交替操作，不能走的玩家失败。假定每个人都采取最优操作（每个人的最优操作为能赢则赢，否则争取平局），求是先手必胜、后手必胜还是平局。</p>
</blockquote>
<p>由于出现了环，可能出现平局的局面。</p>
<p>对于一个状态（棋子在哪个点），我们多定义一个<strong>平局点</strong>，代表从这个位置开始走，不必胜，但可以选择走向平局局面。</p>
<p>首先，对于有向无环图，根据上文”有向图游戏胜负判断”（当然也可以使用数学归纳法）可得：</p>
<ol>
<li>出度为 $0$ 的点为必败点；</li>
<li>只能到达必胜点的状态为必败点；</li>
<li>可以到达必败点的状态为必胜点。</li>
</ol>
<p>假如出现了环，会出现点不满足这上面三个条件的任意一个。</p>
<p>这些点就是平局点，它们每个点都满足“不能到达必胜点，可以到达非必败点（即平局点）”。</p>
<p>反向建图跑拓扑排序即可。</p>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc209/tasks/abc209_e">例题</a></p>
<h2 id="多个有向图游戏的和及SG-定理"><a href="#多个有向图游戏的和及SG-定理" class="headerlink" title="多个有向图游戏的和及SG 定理"></a>多个有向图游戏的和及SG 定理</h2><blockquote>
<p>对于多个有向图游戏的集合 $G=\{G_1,G_2,\ldots,G_n\}$，每次可以任选一个有向图 $G_i$，在 $G_i$ 上走一步，不能走的人失败。</p>
</blockquote>
<p>有向图游戏的和 $G$ 的 SG 函数为 $SG(G_1)\oplus SG(G_2) \oplus \ldots\oplus SG(G_n)$。</p>
<p>证明：</p>
<p>对于每个 $k=SG(G_i)$ 可以看成可以将当前局面的 $SG$  变成 $[0,k)$ 中的任意一个数。</p>
<p>即使有向图游戏会能让 $k$ 变成 $j,j&gt;k$ 也是不妨碍的，因为最优操作是让 $k$ 变成 $0$ ，所以必胜方直接忽略变大的操作即可；即使必败方的 $0$ 转化成了 $j,j&gt;0$，必胜方依然能把 $j$ 变成 $0$，必败方不能无限制变大，必胜方依然是必胜的。</p>
<p>这一定理被称为 <strong>SG 定理</strong>，即为”游戏和的SG函数等于各个游戏SG函数的Nim和”。</p>
<h2 id="Anti-SG-游戏及SJ-定理"><a href="#Anti-SG-游戏及SJ-定理" class="headerlink" title="Anti-SG 游戏及SJ 定理"></a>Anti-SG 游戏及SJ 定理</h2><blockquote>
<p>给定 $n$ 堆物品，第 $i$ 堆物品有 $A_i$ 个。两名玩家轮流行动，每次可以任选一堆，取走任意多个物品，可以一堆取光，但不能不取。取走最后一件物品则<strong>败北</strong>。两人都采取最优策略，问先手能否获胜。</p>
</blockquote>
<p>和 Nim 游戏不同的是，终止情况 $(0,0,\ldots,0)$ 是必胜局面，而不是 Nim 游戏中的必败局面。</p>
<p>证明：</p>
<p>下文称物品数大于 $1$ 的堆为“大堆”，物品数为 $1$ 的堆为“小堆”。</p>
<ol>
<li><p>若都为小堆，每次选择都只能是取走一个小堆。则堆的个数为偶数是必胜局面，堆的个数为奇数是必败局面。</p>
</li>
<li><p>若有大堆：</p>
<ol>
<li><p>大堆个数为 $1$，此时这个局面的 SG 值 $\neq 0$ （因为大堆能决定 SG 值的最高位不是第一位），若总堆数为奇数，将大堆取成小堆，否则就把大堆全取光。取后一定是奇数个小堆，是必败局面。所以当前局面是必胜局面。</p>
</li>
<li><p>大堆个数 $&gt;1$，此时这个局面的 SG 值若 $\neq 0$，则一定能走到一个 SG 值 $=0$ 的局面，且新局面是有大堆的（因为一次最多只能取完一个大堆，而大堆数 $&gt;1$）；此时这个局面的 SG 值若 $=0$，则不管怎样取只能走到 SG 值 $\neq 0$ 且存在大堆的局面。假如前者一直保持那样操作，那么一定是后者进行一步操作后转到2.1.的必胜局面。所以前者是必胜局面，后者是必败局面。</p>
</li>
</ol>
</li>
</ol>
<p>综上所述，先手必胜当且仅当：</p>
<ul>
<li>仅存在小堆且当前局面的 SG 值 $=0$。</li>
<li>存在大堆且当前局面的 SG 值 $\neq 0$。</li>
</ul>
<p>我们把这个结论像 “多个有向图游戏的和 和 SG 定理” 一样推广成更一般的形式：</p>
<p>Q: 为什么不像上一小节 “多个有向图游戏的和 和 SG 定理” 将 ”Nim 游戏“ 和 “多个有向图游戏的和” 直接关联起来呢？</p>
<p>A: 在上一小节中，”Nim 游戏“ 到 “多个有向图游戏的和” 有个步骤是说明 “能走到 SG 值更大的局面” 这一条件是不影响结论的，用取石子模型意思即为可以 “放石子”，但不影响结论。所以在这里需要推广到可以放石子时结论是怎样的。</p>
<p>定义 <strong>Anti-SG 游戏</strong>：</p>
<ol>
<li><p>决策集合为空的游戏者胜利。</p>
</li>
<li><p>其余规则均与 SG 游戏相同。</p>
</li>
</ol>
<p><strong>SJ 定理</strong>：对于任意一个 Anti-SG 游戏，如果规定当局面中所有单一游戏的 SG 值为 $0$ 时，游戏结束。则先手必胜当且仅当：(1) 游戏的 SG 函数不为 $0$ 且游戏中某一个单一游戏的 SG 函数大于 $1$；(2) 游戏的 SG 函数为 $0$ 且游戏中没有单一游戏的 SG 函数大于 $1$。</p>
<p>该定理是贾志豪在 IOI2009中国国家集训队论文《组合游戏略述——浅谈SG游戏的若干拓展及变形》中提出的，也可以去看他的论文。</p>
<p>下面，我将给出按照我自己理解结合《组合游戏略述——浅谈SG游戏的若干拓展及变形》的证明给出一个自认为略微好理解的证明：</p>
<p>我们只需要证明：</p>
<ol>
<li><p>所有终止局面为必胜局面。（由 Anti-SG 游戏的定义可知）。</p>
</li>
<li><p>任何一个必败局面一定只能转移到必胜局面。</p>
</li>
<li><p>任何一个必胜局面至少能转移到一个必败局面。</p>
</li>
</ol>
<p>设游戏的 SG 函数为 $SG$，每个单一游戏的 SG 函数为 $sg$。</p>
<p>现在，我将所有局面分成四类。</p>
<p>必胜局面：</p>
<ol>
<li><p>$SG\neq 0,\exists sg&gt;1$（游戏的 SG 函数不为 $0$ 且存在单一游戏的 SG 函数 $&gt;1$）；</p>
</li>
<li><p>$SG=0,\forall sg\leq 1$（游戏的 SG 函数为 $0$ 且任意单一游戏的 SG 函数 $\leq 1$）。</p>
</li>
</ol>
<p>必败局面：</p>
<ol>
<li><p>$SG\neq 0,\forall sg\leq 1$（游戏的 SG 函数不为 $0$ 且任意单一游戏的 SG 函数 $\leq 1$）；</p>
</li>
<li><p>$SG=0,\exists sg&gt;1$（游戏的 SG 函数为 $0$ 且存在单一游戏的 SG 函数 $&gt;1$）。</p>
</li>
</ol>
<p>下文称 必胜/必败 一/二 代表必胜/必败局面的第1/2种情况，为了方便起见，使用大堆来表示 SG 函数 $&gt;1$ 的单一游戏，小堆为 SG 函数 $=1$ 的游戏。</p>
<p>分好类后证明就很简单了：</p>
<p>关于必胜一的转移：</p>
<ul>
<li>若大堆仅有一个，可以选择取完或者取成小堆，转移成必败一。</li>
<li>若大堆有多个，设 $SG$ 最高位为 $k$，则一定存在一个堆，其第 $k$ 位为 $1$，将其取成 $sg\oplus SG$，由于最多取走一个大堆，所以一定剩有大堆，故可以转移成必败二。</li>
</ul>
<p>关于必胜二的转移：</p>
<ul>
<li>若不可操作，直接胜利。</li>
<li>否则，可以产生一个小堆或者取走一个小堆，转移成必败一。</li>
</ul>
<p>关于必败一的转移：</p>
<ul>
<li><p>若产生一个大堆：因为 $SG\neq 0,\forall sg\leq 1$，所以 $SG=1$，由于大堆的 $sg$ 最高位 $&gt;1$，所以新的 $SG\neq 0$ ，只能转移到必胜一。</p>
</li>
<li><p>若产生一个小堆或者取走一个小堆，只能转移成必胜二。</p>
</li>
<li><p>所以必败一无论怎样操作都只能转移到必胜局面。</p>
</li>
</ul>
<p>关于必败二的转移：</p>
<ul>
<li>因为 $SG=0,\exists sg&gt;1$，所以大堆一定有多个，故只能转移到 $\exists sg&gt;1$ 的局面；$SG=0$ 只能转移到 $SG\neq 0$，否则可以推出没取，与规则矛盾。所以只能转移到必胜一。</li>
</ul>
<p>综上所述，任何一个必败局面一定只能转移到必胜局面，任何一个必胜局面至少能转移到一个必败局面，SJ 定理得证。</p>
<p>值得注意一点的是，在此游戏中，$\forall sg=0$ 时即可认为游戏结束，因为此局面的先手（必败方）无论取什么，后手都能取走新加的，重新转换成 $\forall sg=0$ 的局面，由于必败方不能无限取下去，所以必败方依然会失败。</p>
<p>此定理似乎没有那么重要，仅做了解博弈论证明方式用。</p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4279">例题</a></p>
<h1 id="Part3-例题"><a href="#Part3-例题" class="headerlink" title="Part3 例题"></a>Part3 例题</h1><p><strong>Cutting Game</strong></p>
<blockquote>
<p>给定一张 $N\times M$ 的矩形网格纸，两名玩家轮流行动。</p>
<p>在每一次行动中，可以任选一张矩形网格纸，沿着某一行或某一列的格线，把它剪成两部分。</p>
<p>首先剪出 $1\times 1$ 的格纸的玩家获胜。</p>
<p>两名玩家都采取最优策略行动，求先手是否能获胜。</p>
<p>$2\leq N,M\leq 200$。</p>
</blockquote>
<p>题目链接：<a target="_blank" rel="noopener" href="http://poj.org/problem?id=2311">POJ 2311 Cutting Game</a>，<a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/221/">ACWing 219. 剪纸游戏</a></p>
<p><strong>Solution</strong></p>
<p>最后终止条件为剪出 $1\times 1$ 的获胜，不符公平组合游戏中的 “终止的局面为必败点” 的性质，但可以转化终止的局面，使得终止的局面为必败点。</p>
<p>能剪出 $1\times 1$ 的纸片当且仅当当前为 $1\times x$ 或 $x\times 1,x&gt;1$ 的纸片，这些纸片一定是必败点。</p>
<p>那么把终点定义成当前局面为 $1\times x$ 或 $x\times 1,x&gt;1$，就满足了公平组合游戏的性质。</p>
<p>设 $SG(x,y)$ 为 $x\times y$ 的局面的 SG 函数值。一刀可以横着切也可以竖着切，切完一刀后是分成了两个局面，由 SG 定理，如果这样切当前 SG 函数的值就为分成的两个局面的 SG 函数值的异或值。</p>
<p>所以有：</p>
<script type="math/tex; mode=display">
SG(x,y)=\text{mex}(\{SG(i,y)\oplus SG(x-i,y)\mid 2\leq x-2\}\cup \{SG(x,i)\oplus SG(x,y-i)\mid 2\leq i\leq y-2\})</script><p>注意到 $SG$ 不会超过 $N,M$，则可以在 $\mathcal{O}(N^3)$ 的复杂度内求解，也就是 $\mathcal{O}(N^2)$ 枚举，单次 $\mathcal{O}(N)$ 转移。</p>
<p><strong>Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> SG[<span class="number">210</span>][<span class="number">210</span>], vis[<span class="number">210</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> x = <span class="number">2</span>; x &lt;= <span class="number">200</span>; ++x)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">2</span>; y &lt;= <span class="number">200</span>; ++y) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">200</span>; ++i) vis[i] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; x - i &gt;= <span class="number">2</span>; ++i) vis[SG[i][y] ^ SG[x-i][y]] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; y - i &gt;= <span class="number">2</span>; ++i) vis[SG[x][i] ^ SG[x][y-i]] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">200</span>; ++i)</span><br><span class="line">				<span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">					SG[x][y] = i;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">pre</span>();</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) != EOF)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, SG[n][m] == <span class="number">0</span> ? <span class="string">&quot;LOSE&quot;</span> : <span class="string">&quot;WIN&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="推荐阅读-amp-Reference"><a href="#推荐阅读-amp-Reference" class="headerlink" title="推荐阅读 &amp; Reference"></a>推荐阅读 &amp; Reference</h1><p>算法竞赛进阶指南 0x3A 博弈论 李煜东</p>
<p><a target="_blank" rel="noopener" href="https://github.com/TianyiQ/OI-Public-Library/tree/master/IOI%E4%B8%AD%E5%9B%BD%E5%9B%BD%E5%AE%B6%E5%80%99%E9%80%89%E9%98%9F%E8%AE%BA%E6%96%871999-2019/2009/%E8%B4%BE%E5%BF%97%E8%B1%A">IOI中国国家候选队论文2009 组合游戏略述——浅谈SG游戏的若干拓展及变形 贾志豪</a></p>
<p><a target="_blank" rel="noopener" href="https://oi-wiki.org/math/game-theory/">博弈论 - OI WiKi</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" rel="tag"># 博弈论</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/14/%E3%80%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%8D%E5%88%86%E5%9D%97%E5%92%8C%E8%8E%AB%E9%98%9F/" rel="prev" title="「学习笔记」分块和莫队">
      <i class="fa fa-chevron-left"></i> 「学习笔记」分块和莫队
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/04/06/%E7%9C%81%E9%80%89%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/" rel="next" title="省选数据结构复习">
      省选数据结构复习 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Part1-%E4%BB%8E%E7%BB%8F%E5%85%B8%E5%8F%96%E7%9F%B3%E5%AD%90%E6%B8%B8%E6%88%8F%E5%BC%80%E5%A7%8B"><span class="nav-number">1.</span> <span class="nav-text">Part1 从经典取石子游戏开始</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%B4%E4%BB%80%E5%8D%9A%E5%BC%88"><span class="nav-number">1.1.</span> <span class="nav-text">巴什博弈</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nim-%E6%B8%B8%E6%88%8F"><span class="nav-number">1.2.</span> <span class="nav-text">Nim 游戏</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part2-%E5%8D%9A%E5%BC%88%E8%AE%BA%E7%9A%84%E5%85%B6%E4%BB%96%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-number">2.</span> <span class="nav-text">Part2 博弈论的其他知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F"><span class="nav-number">2.1.</span> <span class="nav-text">有向图游戏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mex-%E8%BF%90%E7%AE%97"><span class="nav-number">2.2.</span> <span class="nav-text">Mex 运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SG-%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.</span> <span class="nav-text">SG 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F%E8%83%9C%E8%B4%9F%E5%88%A4%E6%96%AD"><span class="nav-number">2.4.</span> <span class="nav-text">有向图游戏胜负判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E7%8E%AF%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F"><span class="nav-number">2.5.</span> <span class="nav-text">有环有向图游戏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AA%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F%E7%9A%84%E5%92%8C%E5%8F%8ASG-%E5%AE%9A%E7%90%86"><span class="nav-number">2.6.</span> <span class="nav-text">多个有向图游戏的和及SG 定理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Anti-SG-%E6%B8%B8%E6%88%8F%E5%8F%8ASJ-%E5%AE%9A%E7%90%86"><span class="nav-number">2.7.</span> <span class="nav-text">Anti-SG 游戏及SJ 定理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part3-%E4%BE%8B%E9%A2%98"><span class="nav-number">3.</span> <span class="nav-text">Part3 例题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB-amp-Reference"><span class="nav-number">4.</span> <span class="nav-text">推荐阅读 &amp; Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="do-while-true"
      src="/images/head.gif">
  <p class="site-author-name" itemprop="name">do-while-true</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Friends
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/h-lka/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;h-lka&#x2F;" rel="noopener" target="_blank">Refined_heart</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://shanlunjiajian.github.io/" title="https:&#x2F;&#x2F;shanlunjiajian.github.io&#x2F;" rel="noopener" target="_blank">华山抡剑</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/LFCode/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;LFCode&#x2F;" rel="noopener" target="_blank">LFCode</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://forza-ferrari.github.io/" title="https:&#x2F;&#x2F;forza-ferrari.github.io&#x2F;" rel="noopener" target="_blank">绝顶我为峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/alan-zhao-2007/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;alan-zhao-2007&#x2F;" rel="noopener" target="_blank">Alan_Zhao</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/suxxsfe/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;suxxsfe&#x2F;" rel="noopener" target="_blank">suxxsfe</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://lampese.com/" title="https:&#x2F;&#x2F;lampese.com&#x2F;" rel="noopener" target="_blank">Lampese</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">do-while-true</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
